---
title: "1С:Бухгалтерия 3.0"
permalink: /docs/integration/1c-acc3/
toc: true
---

Внешняя обработка **АРК: Транспортная логистика Online - обмен с сайтом api.arctl.ru** далее обработка АРК

## Возможности обработки АРК

Интеграция реализована для конфигураций **1С:Предприятие 8.3**:

- Бухгалтерия предприятия, редакция 3.0

**Важно!** Обработка АРК может быть использована в 1C Fresh

Для подключения обработки в 1C Fresh нужно сообщить нам:
- контакты вашего поставщика (франчайзе), телефон, почту
- номер абонента в 1C Fresh

Обмен осуществляется со стороны 1С с использованием внешней обработки АРК.

Используйте обработку для:

| Загрузки **АРК -> 1С** | Выгрузки **1С -> АРК** |
| :--- | :--- |
| Справочников | Документов
| Документов | |
| Выполнения связи имеющихся данных в 1С и АРК |

### Соответствие объектов

Таблица соответствие объектов в *1C* и *АРК: Транспортная Логистика OnLine*

| Объект 1С | Объект АРК |
| :--- | :--- |
| **Справочники** |
| Контрагенты  | CRM > Контрагенты |
| Договоры     | CRM > Договоры |
| Номенклатура | Справочники > Шаблоны заявок > Услуги |
| Организации  | Организация > Наши компании |
| **Загрузка (АРК -> 1C)** |
| Счета покупателям | Клиенты > Счета на оплату |
| Реализация (акты, УПД) | Клиенты > Акты / счета-фактуры |
| Поступление (акты, УПД) | Поставщики > Входящие документы |
| Отчеты комитентам (экс.)| Клиенты > Отчеты экспедиторов |
| Платежные поручения (постав.) | Поставщики > Платежный календарь |
| **Выгрузка (1C -> АРК)** |
| Поступление на р/с (клиент.) | Клиенты > Платежи |
| Списание с р/с (постав.) | Поставщики > Платежи |
| Счета от поставщиков | Поставщики > Входящие документы (счет) |
| Поступление (акты, УПД) | Поставщики > Входящие документы (акт) |


### Методы и фильтры

Таблица соответствие объектов в *1C* и *АРК: Транспортная Логистика OnLine*

| Объект 1С | Метод | Фильтр |
| :--- | :--- | :--- |
| **Справочники** |
| Контрагенты  | получить, связать, загрузить | все, новые, связанные |
| Договоры     | получить, связать, загрузить | все, новые, связанные |
| Номенклатура | получить, связать, загрузить | все, новые, связанные |
| Организации  | получить, связать | |
| **Загрузка (АРК -> 1C)** |
| Счета покупателям | получить, загрузить | все, новые, загруженные |
| Реализация (акты, УПД) | получить, загрузить | все, новые, загруженные |
| Поступление (акты, УПД) | получить, загрузить | все, новые, загруженные |
| Отчеты комитентам (экс.)| получить, загрузить | все, новые, загруженные |
| Платежные поручения (постав.) | получить, загрузить | |
| **Выгрузка (1C -> АРК)** |
| Поступление на р/с (клиент.) | получить, выгрузить | |
| Списание с р/с (постав.) | получить, выгрузить | |
| Счета от поставщиков | получить, выгрузить | |
| Поступление (акты, УПД) | получить, выгрузить | |

### Описание методов

| Метод | Описание |
| :--- | :--- |
| получить | обработка получает объекты для выполнения с ними методов связать, загрузить, выгрузить |
| связь | обработка в АРК записывается код объекта из 1С. Дале при обмен используется эта связь|
| загрузить | обработка загружает в 1С справочник или документ из таблицы сформированной методом получить*|
| выгрузить | обработка загружает в АРК документ из таблицы сформированной методом получить* |

* Чтобы объект не загружался / выгружался нужно снять метку "П."

**Важно!** Изменение кода 1С нарушает связь объектов

**Важно!** При изменении в АРК ранее выгруженного документа необходима
повторная выгрузка в 1С. Изменения документов не отслеживаются.
При загрузке документ перезаписывается.

### Описание фильтров

| Фильтр | Описание |
| :--- | :--- |
| все | будут получены все объекты |
| новые | будут получены только новые ранее не связанные и не загруженные |
| загруженные | будут получены только загруженные ранее связанные или загруженные |

## Загрузка обработки АРК

Последняя версия обработки находится по адресу:
[https://gitlab.arctl.ru/dev/arctl_online_1c_acc3/](https://gitlab.arctl.ru/dev/arctl_online_1c_acc3/-/raw/master/bin/arctl_online_1c_acc3.epf).

Рекомендуем после загрузки добавить обработку в дополнительные отчеты и обработки.

## Добавление в дополнительные отчеты и обработки

Откройте *Печатные формы, отчеты и обработки*

![ ](../../images/processing_form.png)

Затем откройте *Дополнительные отчеты и обработки*

![ ](../../images/additional_treatments.png)

В открывшемся окне добавьте обработку

![ ](../../images/additiona_reports.png)

В окне предупреждения нажмите *Продолжить*

![ ](../../images/warning.png)

Выберите файл обработки

![ ](../../images/file_selection.png)

Установите в размещение в разделах.
Рекомендуемые разделы *Продажи*, *Покупки* и *Банк и касса*

![ ](../../images/processing_placement.png)

Укажите место размещения

![ ](../../images/placement_in_sections.png)

Нажмите *Записать и закрыть*

![ ](../../images/external_processing.png)

В любом из разделов, где ранее указали размещение,
необходимо настроить список для отображения.
Для этого перейдите в раздел *Сервис* и выберите *Дополнительные обработки*.

![ ](../../images/processing_service.png)

В открывшемся окне выберите *Настроить список*

![ ](../../images/processing_setting.png)

Выберите обработку **АРК: Транспортная Логистика обмен с сайтом arctl.ru**

![ ](../../images/processing_service_slection.png)

На этом настройка отображения завершена.
Процедура выполняется **один раз** при первом размещении внешней обработки.

## Обновление обработки

Откройте *Печатные формы, отчеты и обработки*

![ ](../../images/processing_form.png)

Затем откройте *Дополнительные отчеты и обработки*

![ ](../../images/additional_treatments.png)

В открывшемся окне выберите обработку "АРК: Транспортная логистика Online - обмен с сайтом api.arctl.ru"

Далее в открывшемся нажмите "Обновить из файла"

![ ](../../images/1c_update_from_file.png)

Выберите файл обработки

![ ](../../images/file_selection.png)

Нажмите *Записать и закрыть*

![ ](../../images/external_processing.png)

Готово, обработка обновлена.

## Запуск обработки АРК

Существует несколько вариантов запуска внешней обработки:

- из списка обработок (рекомендуемый вариант)
- через файл (подходит для однакратного запуска)
- через сохраненный путь

### Из списка обработок

Запуск возможен, если обработка добавлена в
[Дополнительные отчеты и обработки](../1c-acc3/#добавление-в-дополнительные-отчеты-и-обработки).

Откройте раздел *Продажи*, *Покупки* или *Банк и касса*,
затем перейдите в меню *Дополнительные обработки*.

![ ](../../images/service_file.png)

Откройте обработку **АРК: Транспортная Логистика обмен с сайтом arctl.ru**

![ ](../../images/my_additional_processing.png)

### Через файл

Откройте меню *Файл*, *Открыть* и выберите путь к загруженной обработке.

![ ](../../images/open_file.png)

### Через сохраненный путь

Запуск возможен, если раннее обработка открывалась *Через файл*.

Откройте меню *Файл*, затем выберете сохраненный путь до файла обработки.

![ ](../../images/opened_file.png)

## Начало работы с обработкой

Перед использованием обработки после ее запуска выполните начальную настройку:

1. Настройте подключение к **АРК: Транспортная Логистика**.

На вкладке *Настройки* заполните поля *http*, *Пользователь*, *Пароль*

![ ](../../images/start_processing.png)

2. Добавьте внешнюю систему в **АРК: Транспортная Логистика**.

Скопируйте имя внешней системы в обработке.

![ ](../../images/name_processing.png)

Затем добавьте его в справочник внешних систем в
**АРК: Транспортная Логистика**.

![ ](../../images/external_system.png)

3. Проверьте подключение.

Нажмите кнопку *Получить*. Если получен длинный код (уникальный идентификатор),
то обмен настроен успешно.

![ ](../../images/connection_check.png)

4. Далее прежде чем выполнять загрузку / выгрузку необходимо
связать организацию на соответствующей вкладке

## Перед обменом данными

Перед обменом данными необходимо связать *Нашу компанию* (организацию) в
**АРК: Транспортная Логистика** и *Организацию* в **1С**.

Выберите организацию, соответствующую нашей компании, и
нажмите кнопку *Связать*.

![ ](../../images/data_exchange.png)

## Проверка версии обработки АРК

Версия обработки указана в заголовке обработки.

![ ](../../images/1c_processing_version.png)

## Права доступа для обработки АРК

Действия необходимо выполнять, если пользователь сталкивается с ограничением прав доступа

В 1С права доступа должны быть аналогичны профилю групп доступа *Бухгалтер*.

Дополнительно включите *Запуск внешнего соединения* и
*Интерактивное открытие внешних отчетов и обработок*.

1. Добавьте новый профиль через меню *Профили групп доступа*
(Администрирование > Настройки пользователей и прав > Профили групп доступа).

Профиль должен выглядеть примерно так.
В названии укажите, например, “Синхронизация данных с АРК”.

![ ](../../images/group_profile.png)

2. В новый профиль добавьте пользователя через меню *Пользователи*
(Администрирование > Настройки пользователей и прав > Пользователи).

Выберите нужного пользователя добавьте в правах созданный профиль.

![ ](../../images/user.png)

**Важно!** Если пользователь не администратор, то работа обработки может
выполняться, если она включена в *Дополнительные отчеты и обработки*

## Включение отладки

Включение отладки при выполнении POST запросов.
![ ](../../images/debug_on.png)


## Особенности выгрузки услуг

При выгрузке из 1С в АРК: Транспортная логистика OnLine выполняется попытка:

1.  Найти услугу, однозначно совпадающую (одно совпадение) по коду
 
 `1С.Документ.Поступление.Услуги.Номенклатура.Код` =  `АРК:ONLINE.Справочники.Шаблоны заявок.Услуги.<Услуга>.Внешние системы.<Внешняя система>.Код в 1С`

2.  Если услуга не найдена в п.1, то подставляется услуга с кодом  `service_act_supp_1с`

 `АРК:ONLINE.Справочники.ШаблоныЗаявок.Услуги.<Услуга>.Код = service_act_supp_1с`


## Пример загрузки

### Платежные поручения (постав.) из платежного календаря

Порядок действий:

1. *Бухгалтер* в обработке 1С получает строки платежного календаря

  Откройте форму обработки на вкладке *Документы. Загрузка. Платежные поручения (постав.)*, нажмите *Получить*.

  ![ ](/../../images/1c_buh_arctl_Money_orders_get_upload.png)

  При нажатии кнопки *Получить* система автоматически:
  - получает строки платежного календаря:
    -   только акцептованные
    -   ранее не загруженные  
    -   с учетом периода по полю *План. дата*
  - подготавливает загрузку, группируя по полям:
    -   Получатель (контрагент)
    -   Договор
    -   Валюта
    -   Ставка НДС
    -   Счет.

2. Перед загрузкой можно скорректировать поля:
 
   - дата
   - назначение платежа
   - и другие.

3. *Бухгалтер* В обработке 1С загружает платежные поручения

  В форме обработки на вкладке *Документы. Загрузка. Платежные поручения (постав.)* нажмите *Загрузить*.

  При нажатии кнопки *Загрузить* система автоматически:
  - система создаст платежные поручения и заполнит поле *Платежное поручение*
  - в АРК поменяет статусу в платежного календаря на "Загружено в 1С"

  Заполнение поля *Платежное поручение* означает успешную загрузку.
  Если платежное поручении было ранее загружено,
  то при получении поле *Платежное поручение* будет заполнено.